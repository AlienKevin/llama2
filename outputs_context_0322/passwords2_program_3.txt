# Update Password Strength Checker app model based on an action #

let update: (Model, Action) -> Model =
  fun (password, criteria, strength), action ->
    case action
      | UpdatePassword(new_passwd) => (new_passwd, criteria, calculateStrength(new_passwd, criteria))
      | ClearCriteria => (password, [] :: ClearCriteria, Weak)
      | AddCriterion(criteria) => (password, criteria::criteria, strength)
      | RemoveCriterion(criteria) => (password, criteria::criteria, strength)
    end in 
    
let updateWith: Action -> Model -> Model = fun a ->
  fun m ->
    let new_model = update(m, a) in
    new_model
in