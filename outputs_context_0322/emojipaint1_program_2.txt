# Update the EmojiPaint app model based on an action #

let update: (Model, Action) -> Model =
  fun (grid, selectedEmoji, availableEmojis), action ->
    case action
    | SelectEmoji(emoji) => (grid, emoji, availableEmojis)
    | StampEmoji(row, col) => (updateGrid(grid, row, col, selectedEmoji) ,selectedEmoji, availableEmojis)
    | ClearCell(row, col) => 
        let grid = updateGrid(grid, row, col, "") in
          (grid, selectedEmoji, availableEmojis)
    | ClearGrid => (clearGrid(grid) ,selectedEmoji, availableEmojis)
    | FillRow(rowToFill) => 
        let grid = fillRowInGrid(grid, rowToFill, selectedEmoji) in
          (grid, selectedEmoji, availableEmojis) end in
  
let view: Model -> HtmlActionResultTypeModelActionResultTypeModelActionResultTypeHtmlModelActionResulModelActionResulModelActionResulModelActionResultModelActionResulModelActionResulModelActionResulModelActionResultTypeModelActionResultTypeModelActionResultTypeModelActionResultTypeModelActionResult