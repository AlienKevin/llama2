# Update Password Strength Checker app model based on an action #

let update: (Model, Action) -> Model =
  fun (password, criteria, strength), action ->
    case action
      | UpdatePassword(new_passwd) => (new_passwd, criteria, calculateStrength(new_passwd, criteria))
      | ClearCriteria => ("", [], Weak)
      | AddCriterion(criterion) =>
        if List.exists(fun c -> eq(c, criterion), criteria) 
          then (password, criteria, strength) 
          else (password, criteria @ [criterion], strength)
      | RemoveCriterion(criterion) => (
          password, 
          List.filter(fun c: PasswordCriteria -> not(eq(c, criterion)), criteria),
          strength
        )
    end in