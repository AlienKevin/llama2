# Update Password Strength Checker app model based on an action #

let update: (Model, Action) -> Model = fun m, action ->
  case m, action
  | _, UpdatePassword(s) =>
    let new_criteria =
      if string_length(s) == 0 then [MinimumLength(1)] else m#3 in
    (s, new_criteria, calculateStrength(s, new_criteria))
  | (pw, criteria, strength), ClearCriteria => ("", [], Weak)
  | (pw, criteria, strength), AddCriterion(c) =>
    let new_criteria = c::criteria in
    (pw, new_criteria, calculateStrength(pw, new_criteria))
  | (pw, criteria, strength), RemoveCriterion(c) =>
    let new_criteria = List.filter((fun x -> x <> c), criteria) in
    (pw, new_criteria, calculateStrength(pw, new_criteria))
end