type AlignmentType =
    + Start
    + Center
    + End
in

type Attribute =
    + Padding(Int)
    + Margin(Int)
    + Alignment(AlignmentType)
    + Color(String)
in

type Widget =
    + Text(String, [Attribute])
    + Column([Widget], [Attribute])
    + Row([Widget], [Attribute])
    + Container(Widget, [Attribute])
in

let find_all_widgets_of_type: (Widget, Widget -> Bool) -> [Widget] = fun (widget, is_type) ->
    let find_children: [Widget] -> [Widget] =
        fun children ->
            case children
            | [] => []
            | hd::tl =>
                let results = find_all_widgets_of_type(hd, is_type) in
                results @ find_children(tl)
            end
    in
    let find_group: (Widget, [Widget]) -> [Widget] =
        fun widget, children ->
            if is_type(widget) then
                widget :: find_children(children)
            else
                find_children(children)
    in
    case widget
    | Column(children, _) =>
        find_group(widget, children)
    | Row(children, _) =>
        find_group(widget, children)
    | Container(child, _) =>
        find_group(widget, [child])
    | _ =>
        if is_type(widget) then [widget] else []
    end
in
