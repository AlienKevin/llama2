# TODO MVU: Handle TODO actions to update the app model #

let update: (Model, Action) -> Model =
  fun (buffer, todos), action ->
    case action
    | AddTodo => ("", add(buffer, todos))
    | RemoveTodo index => buffer, remove(index, todos)
    | ToggleTodo index => buffer, toggle(index, todos)
    | UpdateBuffer description => (description, todos) end in
# TODO MVU: View functions #
let View.render_todos: ([Todo], String -> Int -> String) -> String =
  fun (ts), render_todo ->
    case ts
    | [] => ""
    | hd::tl => 
      let todo = render_todo(hd) in
      if tl $== [] then todo else todo ^ "\n" ^ View.render_todos(tl, render_todo) end in