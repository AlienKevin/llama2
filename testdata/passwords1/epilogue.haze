# PASSWORD CHECKER MVU TESTS #

test
  let model = update(initialModel, UpdatePassword("pass")) in
  let (password, _, strength) = model in
  password == "pass" && strength == Weak  
end;

test
  let model = update(initialModel, UpdatePassword("password")) in
  let (password, _, strength) = model in
  password == "password" && strength == Moderate 
end;
      
test
  let model = update(initialModel, UpdatePassword("Password123")) in
  let (password, _, strength) = model in
  password == "Password123" && strength == Strong 
end;
  
test
  let model = update(initialModel, UpdatePassword("password")) in
  let model = update(model, AddCriterion(RequireUppercase)) in
  let (password, criteria, strength) = model in
  password == "password" && List.length(criteria) == 4 && strength == Moderate 
end;

test
  let model = update(initialModel, UpdatePassword("Password123")) in
  let model = update(model, RemoveCriterion(RequireUppercase)) in
  let (password, criteria, strength) = model in
  password == "Password123" && List.length(criteria) == 2 && strength == Moderate 
end;

test
  let model = update(initialModel, UpdatePassword("pass")) in
  let model = update(model, RemoveCriterion(MinLength(8))) in
  let (password, criteria, strength) = model in
  password == "pass" && List.length(criteria) == 2 && strength == Weak 
end;
