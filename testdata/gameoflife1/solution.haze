# GAME OF LIFE MVU: Update function handles actions to update the model #

let update: (Model, Action) -> Model =
fun (grid, generations), action ->
    case action
    | InitializeGrid(g) => (g, 0)
    | NextGeneration => (next_grid(grid), generations + 1)
    | ToggleCell(index) =>  
      (Grid.set(grid, index, !Grid.at(grid, index)), generations)  
      end in
