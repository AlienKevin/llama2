# Update the Room Booking app model based on an action #

let update: (Model, Action) -> Model =
  fun (formState, bookings, nextId), action ->
    case action
      | AddBooking(user, weekday, timeOfDay) =>
        let newBooking = ((weekday, timeOfDay), user, nextId) in
        (((weekday, timeOfDay), user), newBooking :: bookings, nextId + 1)
      | CancelBooking(user, id) =>
        (formState, rm_booking(user, id ,bookings), nextId)
      | ClearBookings =>
        (formState, [], nextId) 
    end  
in
