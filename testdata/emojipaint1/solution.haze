# Update the EmojiPaint app model based on an action #

let update: (Model, Action) -> Model =
  fun (grid, selectedEmoji, emojiList), action ->
    case action 
    | SelectEmoji(emoji) =>
      (grid, emoji, emojiList)
    | StampEmoji(row, col) =>
      (updateGrid(grid, row, col, selectedEmoji), selectedEmoji, emojiList)
    | ClearCell(row, col) =>
      (updateGrid(grid, row, col, ""), selectedEmoji, emojiList)
    | ClearGrid =>
      (clearGrid(grid), selectedEmoji, emojiList)
    | FillRow(row) =>
      (fillRowInGrid(grid, row, selectedEmoji), selectedEmoji, emojiList) 
    end in
