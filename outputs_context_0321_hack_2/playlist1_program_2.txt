# Update Playlist app model based on an action #

let update: (PlayList, PlayListAction) -> PlayList =
  fun playlist, action ->
    let songs, current = playlist in
     case action
     | PlaySong(id) => 
       if get_state(playlist) == NoSongSelected then 
        (songs, Playing(id))
       else
         (songs, PausedOn(id))
     | PauseCurrentSong => 
      case current 
       | Playing(id) => (songs, PausedOn(id))
       | PausedOn(id) => (songs, NoSongSelected)
       | NoSongSelected => playlist end
     | RemoveSong(id) => 
      if id == get_state(playlist) then (songs, NoSongSelected) else playlist
     | AddSong(id) =>
        let songs = 
          if (get_songs(playlist)) == [] then [id] else
            if (get_songs(playlist)) != [] && get_songs(playlist) @ [id] == id::songs then songs else id::songs in
        playlist
   end 
in