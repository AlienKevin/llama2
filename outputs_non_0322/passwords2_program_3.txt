# Update Password Strength Checker app model based on an action #

let update: (Model, Action) -> Model =
  fun (password, criteria, strength), action ->
    case action
     | UpdatePassword(new_passwd) => (new_passwd, criteria, calculateStrength(new_passwd, criteria))
     | ClearCriteria => ("", [], Weak)
     | AddCriterion(criterion) => ("", List.cons(criterion, criteria), calculateStrength("", criterion::criteria))
     | RemoveCriterion(criterion) => ("", List.filter(fun c: PasswordCriteria -> c != criterion, criteria), calculateStrength("", criteria))
  end in